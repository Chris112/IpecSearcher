<!DOCTYPE html>

<html>
    <head>
        <title>IPEC Searcher</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="js/libs/twitter-bootstrap/css/bootstrap.css" type="text/css"/>
        <link href="theme.css" rel="stylesheet" type="text/css">
    </head>
    <body>

        <div class="jumbotron container">

            <!-- Heading with logo -->
            <center>
                <img align="middle" id="tollLogo" src="http://i.imgur.com/e1t9h3c.jpg" class="img-responsive" alt="logo">
            </center>
            <br>


            <div class="container">

                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                    <li class="active">
                        <a href="#destination" role="tab" data-toggle="tab">
                            Find Destination
                        </a>
                    </li>
                    <li><a href="#suburbSearch" role="tab" data-toggle="tab">
                            Find Suburb
                        </a>
                    </li>
                    <li>
                        <a href="#postcodeSearch" role="tab" data-toggle="tab">
                            Find Postcode
                        </a>
                    </li>
                    <li>
                        <a href="#showMap" role="tab" data-toggle="tab">
                            Current map
                        </a>
                    </li>
                    <li>
                        <a href="#reportErrorTab" role="tab" data-toggle="tab">
                            Report
                        </a>
                    </li>
                </ul>


                <!-- Tab panes -->
                <div class="tab-content">
                    <div class="tab-pane fade active in" id="destination">

                        <!-- Find Destination content -->
                        <h2>Enter postcode to find destination</h2>
                        <form role="form">
                            <div class="form-group ">
                                <label for="postcode">Postcode:</label>
                                <input type="text" class="form-control" id="postcode">
                            </div>
                            <button type="submit" class="btn btn-default">Submit</button>
                        </form>

                    </div>


                    <!-- Find Suburb content -->
                    <div class="tab-pane fade" id="suburbSearch">
                        <h2>Enter postcode to find the suburb</h2>
                        <div class="col-xs-2"></div>
                        <div class="col-xs-8">Enter postcode below:
                            <form>
                                <input type="hidden" id="lastUsedRID" name="lastUsedRID" value="0">
                                <input class="form-control" type="text" placeholder="eg: 6000" onkeyup="showHintSuburb(this.value)">
                                Suburb: <span id="suburbHint"></span>
                            </form>
                            <div class="col-xs-2"></div>
                        </div>
                        <br><br><br><br><br><br>
                    </div>


                    <!-- Find Postcode content -->
                    <div class="tab-pane fade" id="postcodeSearch">
                        <h2>Enter suburb to find postcode</h2>
                        <div class="col-xs-2"></div>
                        <div class="col-xs-8">Enter suburb below:
                            <form>
                                <input class="form-control" type="text" placeholder="eg: Mount Lawley"  onkeyup="showHintPostcode(this.value)">
                            </form>
                            Postcode: <span id="postcodeHint"></span>
                            <div class="col-xs-2"></div>
                        </div>
                        <br><br><br>
                    </div>

                    <!-- Show map content -->
                    <div class="tab-pane fade" id="showMap">
                        <h2>Current map</h2>
                        <!--<div class="col-xs-8">-->
                        <img src="http://i.imgur.com/8b7LMei.jpg" class="img-responsive" alt="warehouse map cleaned"/>
                        <br><br><br>
                    </div>






                    <!-- Report Error content -->
                    <div class="tab-pane fade" id="reportErrorTab">
                        <h2>Report Error</h2>
                        <div class="col-xs-2"></div>
                        <div class="col-xs-8">
                            Please include as much detail as you can

                            <form action="reportError.php" method="post">
                                <p>Description of error: <input type="text" name="errorDescription" /></p>
                                <input type="submit" name="submit" value="Submit" />
                            </form>




                            <div class="col-xs-2"></div>
                        </div>
                        <br><br><br>
                    </div>

                    <script>




                        $rid = 1000;
                        $lastUsedRID = -1;
                        function showHintSuburb(str) {
                            if (str.length == 0) {
                                document.getElementById("suburbHint").innerHTML = "";
                                return;
                            } else {
                                var xmlhttp = new XMLHttpRequest();
                                xmlhttp.onreadystatechange = function () {
                                    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

                                        // get new RID
                                        var OriginalString = xmlhttp.responseText;
                                        var StrippedString = OriginalString.replace(/(<([^>]+)>)/ig, "");
                                        var currRID = StrippedString.substr(StrippedString.length - 4, StrippedString.length);

                                        // if new RID is greater than previous RID, update element otherwise do nothing
                                        if (currRID > $("#lastUsedRID").val()) {
                                            document.getElementById("suburbHint").innerHTML = xmlhttp.responseText.substr(0, xmlhttp.responseText.length - 4);
                                            $("#lastUsedRID").val(currRID);
                                        }
                                    }
                                };
                                xmlhttp.open("GET", "suggestSuburb.php?q=" + str + "&rid=" + ++$rid, true);
                                xmlhttp.send();
                            }
                        }


                        function showHintPostcode(str) {
                            if (str.length == 0) {
                                document.getElementById("postcodeHint").innerHTML = "";
                                return;
                            } else {
                                var xmlhttp = new XMLHttpRequest();
                                xmlhttp.onreadystatechange = function () {
                                    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                                        // get new RID
                                        var OriginalString = xmlhttp.responseText;
                                        var StrippedString = OriginalString.replace(/(<([^>]+)>)/ig, "");
                                        var currRID = StrippedString.substr(StrippedString.length - 4, StrippedString.length);

                                        // if new RID is greater than previous RID, update element otherwise do nothing
                                        console.log(currRID + " vs " + $("#lastUsedRID").val());
                                        if (currRID > $("#lastUsedRID").val()) {

                                            //if (currRID > $rid) {
                                            document.getElementById("postcodeHint").innerHTML = xmlhttp.responseText.substr(0, xmlhttp.responseText.length - 4);
                                            //$lastUsedRID = currRID;
                                            $("#lastUsedRID").val(currRID);
                                        }
                                    }
                                };
                                xmlhttp.open("GET", "suggestPostcode.php?q=" + str + "&rid=" + ++$rid, true);
                                xmlhttp.send();
                            }
                        }
                    </script>





                    <!--<div class = "background"></div>
                    <div class = "content"></div>
                    <img style="width:50%;height:auto;" src="http://i.imgur.com/4LwTsyu.jpg" class="img-responsive" alt="Cinque Terre" >-->

                </div>







                <!--<script> src = "js/libs/jquery/jquery.js" ></script>
                <script> src = "js/libs/twitter-bootstrap/js/bootstrap.js" ></script>
                <script> src = "js/libs/twitter-bootstrap/js/bootstrap.tab.js" ></script>-->

            </div> <!-- /container -->
        </div> <!-- /jumbotron -->

        <footer class="footer">
            <p>&copy; 2015 Company, Inc.</p>
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    </body>
</html>
